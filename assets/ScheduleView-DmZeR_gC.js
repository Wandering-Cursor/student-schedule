import{D as $,V as P,o as n,d as h,a5 as T,v as r,A as _,t as c,b as m,Y as V,f as B,x as l,_ as F,H as N,$ as w,E as g,a1 as U,a0 as A,c as v,F as E,z as G}from"./index-CbmMQgMp.js";import{a as H,b as O}from"./index-CSJKlkpU.js";import{s as j}from"./index-Db6wunYQ.js";import{s as q}from"./index-DH2aIp75.js";import{a as z}from"./schedule-DGlYnt7H.js";import{s as M}from"./index-CD9okw-L.js";import{a as W,b as Y}from"./datetime-DUZGPrj3.js";import{V as D}from"./Variant-Cxq8psV2.js";import{g as x}from"./urls-BBdSs22m.js";import{A as S}from"./AnyLink-BeVkD_y0.js";import{s as J,a as K}from"./index-CNDfSc_D.js";import"./index-B342O1Zq.js";import"./index-BpuD4ofM.js";import"./index-BRNBrPPd.js";import"./index-BapIrWAp.js";const Q={class:"contained-wrapper schedule-item"},R=$({__name:"ShortCombinedScheduleItem",props:{schedule:{type:Object,required:!0}},setup(t){const d=t,s=P(),i=e=>`${W(e.for_date)} - ${e.for_date?Y(e.for_date):""}`,f=()=>{const e=s.getGroup();return e&&d.schedule.group_schedules.some(a=>a.group.uuid===e.uuid)?"schedule.group.userGroupIncluded":""};return(e,a)=>{const o=M;return n(),h(o,null,T({title:r(()=>[_(c(i(t.schedule)),1)]),content:r(()=>[m("div",Q,[t.schedule.photo_schedule?(n(),h(S,{key:0,"id-field":V(x)(t.schedule.photo_schedule),"name-field":e.$t("schedule.photo.title"),linkTo:"photo-schedule",variant:V(D).H3},null,8,["id-field","name-field","variant"])):B("",!0),l(S,{"id-field":t.schedule.uuid,"name-field":e.$t("labels.view"),linkTo:"schedule-detail",variant:V(D).H4,useLink:!1,class:"schedule-link"},null,8,["id-field","name-field","variant"])])]),_:2},[t.schedule.group_schedules.length>0?{name:"subtitle",fn:r(()=>[_(c(e.$t("schedule.group.count",{count:t.schedule.group_schedules.length}))+" ",1),a[0]||(a[0]=m("br",null,null,-1)),_(" "+c(e.$t(f())),1)]),key:"0"}:void 0]),1024)}}}),X=F(R,[["__scopeId","data-v-bd0268f2"]]),Z={class:"filter-panel"},ee={for:"for-date-input"},te={for:"from-date-input"},ae={for:"to-date-input"},le=$({__name:"ScheduleFilters",props:{filters:{type:Object,required:!0},collapsed:{type:Boolean,default:!0},toggleable:{Boolean,default:!0},loading:{type:Boolean,default:!1}},emits:["update:filters"],setup(t,{emit:d}){const s=d,i=t,f=()=>{s("update:filters",i.filters)};return(e,a)=>{const o=J,p=K,b=N,y=w;return n(),h(y,{header:e.$t("labels.filters"),toggleable:t.toggleable,collapsed:t.collapsed},{default:r(()=>[m("div",Z,[l(p,{variant:"on",class:"input-field"},{default:r(()=>[l(o,{modelValue:t.filters.forDate,"onUpdate:modelValue":a[0]||(a[0]=u=>t.filters.forDate=u),id:"for-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",ee,c(e.$t("schedule.filters.forDate")),1)]),_:1}),l(p,{variant:"on",class:"input-field"},{default:r(()=>[l(o,{modelValue:t.filters.dateFrom,"onUpdate:modelValue":a[1]||(a[1]=u=>t.filters.dateFrom=u),id:"from-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",te,c(e.$t("schedule.filters.fromDate")),1)]),_:1}),l(p,{variant:"on",class:"input-field"},{default:r(()=>[l(o,{modelValue:t.filters.dateTo,"onUpdate:modelValue":a[2]||(a[2]=u=>t.filters.dateTo=u),id:"to-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",ae,c(e.$t("schedule.filters.toDate")),1)]),_:1}),l(b,{label:e.$t("labels.applyFilters"),onClick:f,disabled:t.loading},null,8,["label","disabled"])])]),_:1},8,["header","toggleable","collapsed"])}}}),oe=F(le,[["__scopeId","data-v-12a4fe74"]]),se={class:"contained-wrapper"},ne=$({__name:"CombinedSchedule",setup(t){const d=g(0),s=g(!1),i=g(),f=g({count:0,next:null,previous:null,results:[]}),e=U({page:1,forDate:void 0,dateTo:void 0,dateFrom:void 0}),a=async()=>{s.value=!0;try{const o=await z(e);f.value=o.data,i.value=o.data.results,d.value=e.page*10-10}catch(o){if(e.page!=1)return e.page=1,console.debug("Error loading page, retrying with page 1"),a();throw o}s.value=!1};return A(async()=>{await a()}),(o,p)=>{const b=q,y=j,u=H,C=O,L=w;return n(),v("main",se,[s.value?(n(),h(b,{key:0,width:"100%",height:"50vh"})):(n(),h(oe,{key:1,filters:e,loading:s.value,"onUpdate:filters":a},null,8,["filters","loading"])),l(L,null,{default:r(()=>[s.value?B("",!0):(n(),h(u,{key:0,value:i.value,"data-key":"uuid",rows:10},{list:r(k=>[(n(!0),v(E,null,G(k.items,I=>(n(),v("div",null,[l(X,{schedule:I},null,8,["schedule"]),l(y)]))),256))]),_:1},8,["value"])),l(C,{"total-records":f.value.count,rows:10,onPage:p[0]||(p[0]=k=>{e.page=k.page+1,a()}),first:d.value},null,8,["total-records","first"])]),_:1})])}}}),re={class:"contained-wrapper"},Ve=$({__name:"ScheduleView",setup(t){return(d,s)=>{const i=w;return n(),v("main",re,[l(i,{header:d.$t("schedule.title")},{default:r(()=>[_(c(d.$t("schedule.description")),1)]),_:1},8,["header"]),l(ne)])}}});export{Ve as default};
