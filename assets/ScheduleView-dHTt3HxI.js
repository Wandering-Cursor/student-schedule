import{D as w,o as l,d as p,v as n,A as V,t as m,Y as v,b as c,f as _,c as h,F as B,z as S,x as t,H as C,_ as F,E as $,a1 as U,a0 as G,$ as P}from"./index-D4mTkDQv.js";import{a as H,b as j}from"./index-DOWd_jCY.js";import{s as q,a as x}from"./index-5vIUcVV4.js";import{s as z,a as M}from"./index-BpA1yPb7.js";import{s as O}from"./index-iRe7_XGU.js";import{g as W}from"./schedule-BThnsp-8.js";import{a as Y}from"./datetime-CUQ1yG2p.js";import{G as J}from"./GroupLink-aRF4CLIO.js";import{V as D}from"./Variant-Cxq8psV2.js";import{A as K}from"./AnyLink-CwkD27St.js";import"./index-Dp8pu7ri.js";import"./index-C7rt1Uxd.js";import"./index-DSSuZ8ZU.js";import"./index-BzTMKdjU.js";const Q=o=>{o.endsWith("/")&&(o=o.slice(0,-1));const a=o.split("/");return a[a.length-1]},R={class:"contained-wrapper schedule-item"},X={key:1,class:"group-schedule"},Z={class:"group-schedule-container"},ee=w({__name:"CombinedScheduleItem",props:{schedule:{type:Object,required:!0}},setup(o){return(a,d)=>{const i=C,f=q;return l(),p(f,null,{title:n(()=>[V(m(v(Y)(o.schedule.for_date)),1)]),content:n(()=>[c("div",R,[o.schedule.photo_schedule?(l(),p(K,{key:0,"id-field":v(Q)(o.schedule.photo_schedule),"name-field":a.$t("schedule.photo.title"),linkTo:"photo-schedule",variant:v(D).H3},null,8,["id-field","name-field","variant"])):_("",!0),o.schedule.group_schedules.length>0?(l(),h("div",X,[V(m(a.$t("schedule.group.title"))+" ",1),c("div",Z,[(l(!0),h(B,null,S(o.schedule.group_schedules,e=>(l(),p(f,{key:o.schedule.uuid},{content:n(()=>[t(J,{"group-i-d":e.group.uuid,"group-name":e.group.name,variant:v(D).P,class:"group-schedule-item-content"},null,8,["group-i-d","group-name","variant"])]),footer:n(()=>[t(i,{as:"router-link",label:a.$t("labels.view"),to:`/schedule/group/${e.uuid}`,class:"group-schedule-item-content"},null,8,["label","to"])]),_:2},1024))),128))])])):_("",!0)])]),_:1})}}}),te=F(ee,[["__scopeId","data-v-296cda36"]]),oe={class:"filter-panel"},ae={for:"for-date-input"},le={for:"from-date-input"},se={for:"to-date-input"},ne=w({__name:"CombinedSchedule",setup(o){const a=$(0),d=$(!1),i=$(),f=$({count:0,next:null,previous:null,results:[]}),e=U({page:1,forDate:void 0,dateTo:void 0,dateFrom:void 0}),g=async()=>{d.value=!0;try{const s=await W(e);f.value=s.data,i.value=s.data.results,a.value=e.page*10-10}catch(s){if(e.page!=1)return e.page=1,console.debug("Error loading page, retrying with page 1"),g();throw s}d.value=!1};return G(async()=>{await g()}),(s,u)=>{const L=O,b=z,k=M,I=C,y=P,T=x,N=H,A=j;return l(),h("main",null,[t(y,{header:s.$t("schedule.combined")},{default:n(()=>[d.value?(l(),p(L,{key:0,width:"100%",height:"50vh"})):_("",!0),d.value?_("",!0):(l(),p(y,{key:1,header:s.$t("labels.filters"),toggleable:"",collapsed:!0},{default:n(()=>[c("div",oe,[t(k,{variant:"on",class:"flex"},{default:n(()=>[t(b,{modelValue:e.forDate,"onUpdate:modelValue":u[0]||(u[0]=r=>e.forDate=r),id:"for-date-input",showButtonBar:""},null,8,["modelValue"]),c("label",ae,m(s.$t("schedule.filters.forDate")),1)]),_:1}),t(k,{variant:"on",class:"flex"},{default:n(()=>[t(b,{modelValue:e.dateFrom,"onUpdate:modelValue":u[1]||(u[1]=r=>e.dateFrom=r),id:"from-date-input",showButtonBar:""},null,8,["modelValue"]),c("label",le,m(s.$t("schedule.filters.fromDate")),1)]),_:1}),t(k,{variant:"on",class:"flex"},{default:n(()=>[t(b,{modelValue:e.dateTo,"onUpdate:modelValue":u[2]||(u[2]=r=>e.dateTo=r),id:"to-date-input",showButtonBar:""},null,8,["modelValue"]),c("label",se,m(s.$t("schedule.filters.toDate")),1)]),_:1}),t(I,{label:s.$t("labels.applyFilters"),onClick:g,disabled:d.value},null,8,["label","disabled"])])]),_:1},8,["header"])),d.value?_("",!0):(l(),p(N,{key:2,value:i.value,"data-key":"uuid",rows:10},{list:n(r=>[(l(!0),h(B,null,S(r.items,E=>(l(),h("div",null,[t(te,{schedule:E},null,8,["schedule"]),t(T)]))),256))]),_:1},8,["value"])),t(A,{"total-records":f.value.count,rows:10,onPage:u[3]||(u[3]=r=>{e.page=r.page+1,g()}),first:a.value},null,8,["total-records","first"])]),_:1},8,["header"])])}}}),re=F(ne,[["__scopeId","data-v-1734f447"]]),de={class:"contained-wrapper"},we=w({__name:"ScheduleView",setup(o){return(a,d)=>{const i=P;return l(),h("main",de,[t(i,{header:a.$t("schedule.title")},{default:n(()=>[V(m(a.$t("schedule.description")),1)]),_:1},8,["header"]),t(re)])}}});export{we as default};
