import{D as w,u as U,o as s,d as h,v as l,A as V,t as i,Y as k,b as m,f as _,c as f,F as D,z as B,x as e,H as C,_ as S,E as v,a1 as G,a0 as R,$ as F}from"./index-BrBohaib.js";import{a as j,b as q}from"./index-D5OUCS-i.js";import{s as x,a as z}from"./index-C4AfYss8.js";import{s as A,a as H}from"./index-e1NHwUBX.js";import{s as M}from"./index-Cr4lsAIy.js";import{g as O}from"./schedule-D7uK0vCE.js";import{a as W}from"./datetime-DffBx5oN.js";import{G as Y}from"./GroupLink-CgrXcTY7.js";import{V as J}from"./Variant-Cxq8psV2.js";import"./index-B58__QSc.js";import"./index-DfTK9ASj.js";import"./index-ZDwHx5Pw.js";import"./index-_6VsTQOa.js";const K=o=>{o.endsWith("/")&&(o=o.slice(0,-1));const a=o.split("/");return a[a.length-1]},Q={key:1,class:"group-schedule"},X={class:"group-schedule-container"},Z=w({__name:"CombinedScheduleItem",props:{schedule:{type:Object,required:!0}},setup(o){return(a,u)=>{const p=U("RouterLink"),g=C,t=x;return s(),h(t,null,{title:l(()=>[V(i(k(W)(o.schedule.for_date)),1)]),content:l(()=>[o.schedule.photo_schedule?(s(),h(p,{key:0,to:`/schedule/photo/${k(K)(o.schedule.photo_schedule)}`},{default:l(()=>[m("h3",null,i(a.$t("schedule.photo")),1)]),_:1},8,["to"])):_("",!0),o.schedule.group_schedules?(s(),f("div",Q,[V(i(a.$t("schedule.group"))+" ",1),m("div",X,[(s(!0),f(D,null,B(o.schedule.group_schedules,d=>(s(),h(t,{key:o.schedule.uuid},{content:l(()=>[e(Y,{"group-i-d":d.group.uuid,"group-name":d.group.name,variant:k(J).P,class:"group-schedule-item-content"},null,8,["group-i-d","group-name","variant"])]),footer:l(()=>[e(g,{as:"router-link",label:a.$t("schedule.view"),to:`/schedule/group/${d.uuid}`,class:"group-schedule-item-content"},null,8,["label","to"])]),_:2},1024))),128))])])):_("",!0)]),_:1})}}}),ee=S(Z,[["__scopeId","data-v-c6b1525e"]]),te={class:"filter-panel"},oe={for:"for-date-input"},ae={for:"from-date-input"},se={for:"to-date-input"},le=w({__name:"CombinedSchedule",setup(o){const a=v(0),u=v(!1),p=v(),g=v({count:0,next:null,previous:null,results:[]}),t=G({page:1,forDate:void 0,dateTo:void 0,dateFrom:void 0}),d=async()=>{u.value=!0;try{const n=await O(t);g.value=n.data,p.value=n.data.results,a.value=t.page*10-10}catch(n){if(t.page!=1)return t.page=1,console.debug("Error loading page, retrying with page 1"),d();throw n}u.value=!1};return R(async()=>{await d()}),(n,c)=>{const L=M,$=A,b=H,P=C,y=F,I=z,N=j,T=q;return s(),f("main",null,[e(y,{header:n.$t("schedule.combined")},{default:l(()=>[u.value?(s(),h(L,{key:0,width:"100%",height:"50vh"})):_("",!0),u.value?_("",!0):(s(),h(y,{key:1,header:n.$t("labels.filters"),toggleable:"",collapsed:!0},{default:l(()=>[m("div",te,[e(b,{variant:"on",class:"flex"},{default:l(()=>[e($,{modelValue:t.forDate,"onUpdate:modelValue":c[0]||(c[0]=r=>t.forDate=r),id:"for-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",oe,i(n.$t("schedule.filters.forDate")),1)]),_:1}),e(b,{variant:"on",class:"flex"},{default:l(()=>[e($,{modelValue:t.dateFrom,"onUpdate:modelValue":c[1]||(c[1]=r=>t.dateFrom=r),id:"from-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",ae,i(n.$t("schedule.filters.fromDate")),1)]),_:1}),e(b,{variant:"on",class:"flex"},{default:l(()=>[e($,{modelValue:t.dateTo,"onUpdate:modelValue":c[2]||(c[2]=r=>t.dateTo=r),id:"to-date-input",showButtonBar:""},null,8,["modelValue"]),m("label",se,i(n.$t("schedule.filters.toDate")),1)]),_:1}),e(P,{label:n.$t("labels.applyFilters"),onClick:d,disabled:u.value},null,8,["label","disabled"])])]),_:1},8,["header"])),u.value?_("",!0):(s(),h(N,{key:2,value:p.value,"data-key":"uuid",rows:10},{list:l(r=>[(s(!0),f(D,null,B(r.items,E=>(s(),f("div",null,[e(ee,{schedule:E},null,8,["schedule"]),e(I)]))),256))]),_:1},8,["value"])),e(T,{"total-records":g.value.count,rows:10,onPage:c[3]||(c[3]=r=>{t.page=r.page+1,d()}),first:a.value},null,8,["total-records","first"])]),_:1},8,["header"])])}}}),ne=S(le,[["__scopeId","data-v-1734f447"]]),re={class:"contained-wrapper"},ke=w({__name:"ScheduleView",setup(o){return(a,u)=>{const p=F;return s(),f("main",re,[e(p,{header:a.$t("schedule.title")},{default:l(()=>[V(i(a.$t("schedule.description")),1)]),_:1},8,["header"]),e(ne)])}}});export{ke as default};
